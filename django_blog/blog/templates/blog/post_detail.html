{% extends "blog/base.html" %}

{% block title %}{{ post.title }}{% endblock %}

{% block content %}
    <h1>{{ post.title }}</h1>
    <p class="date">
        Published {{ post.published_date }} by {{ post.author }}
    </p>
    {{ post.content|linebreaks }}
    <a href="{% url 'post_edit' post.pk %}">Edit Post</a>
    <a> | </a>
    <a href="{% url 'post_delete' post.pk %}">Delete Post</a>

    {% with comments.count as total_comments %}
        <h2>
            {{ total_comments }} comment{{ total_comments|pluralize }}
        </h2>
    {% endwith %}
    {% for comment in comments %}
        <div class="comment">
            <p class="info">
                Comment {{ forloop.counter }} by {{ comment.author.username }}
                {{ comment.created_at|date:"M d, Y H:i" }}
            </p>
            {{ comment.content|linebreaks }}
            {% if user == comment.author %}
                <a href="{% url 'edit_comment' comment.pk %}">Edit</a> |
                <a href="{% url 'delete_comment' comment.pk %}">Delete</a>
            {% endif %}
        </div>
        {% empty %}
            <p>No comments yet. Be the first to comment!</p>
    {% endfor %}
    <form action="{% url 'new_comment' %}" method="post">
            {% csrf_token %}
            <button type="submit">Add Comment</button>
    </form>
{% endblock %}
